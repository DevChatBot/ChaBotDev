<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Chatbot Desenvovimento</title>
    <style>
      body {
        height: 100vh;
        display: flex;
        align-items: center;
        background: linear-gradient(to top left, #030a4b, #555dc0);
      }
      h1 {
        font-family: sans-serif;
        font-size: 50px;
        line-height: 1.3;
        width: 100%;
        padding: 30px;
        text-align: center;
        color: white;
      }
    </style>
  </head>
  <body>
   <h1>Chatbot – Desenvolvimento</h1>
      <script type="text/javascript">

// Cria uma nova data no futuro 01/01/2020
var data = new Date(2020,0,01);
// Converte a data para GMT
// Wed, 01 Jan 2020 02:00:00 GMT
//data = data.toGMTString();  
        
// Cria o cookie
//document.cookie = 'PORTAL_INTEGRACAO=7e74996d-2ae6-4bf8-b05b-1ade85569828; expires=' + data + '; path=/'; 
        
//LER COOKIE
let x = document.cookie;
console.log("Cookie: " + x); 
        
var url_string = window.location.href;
var url = new URL(url_string);
var notEmail = 'semEmail';
var acessChat = url.searchParams.get("acessChat");
if (acessChat !== null) {
    localStorage.setItem('chatbot-info-student', acessChat.replaceAll('@', '7a5r9o3b2a0').replaceAll('.', '5p6o3n6t2o'));
} else if (acessChat === null) {
    localStorage.setItem('chatbot-info-student', notEmail);
}

function getCookie(name) {
    console.log("Entrou na função getCookie");
    var cookieArr = document.cookie.split(";");
    console.log("Cookie Arr" + cookieArr);
    for (var i = 0; i < cookieArr.length; i++) {
        var cookiePair = cookieArr[i].split("=");
        consolo.log("cookiepair antes do if: " + cookiePair)
        if (name == cookiePair[0].trim()) {
            console.log(decodeURIComponent(cookiePair[1]));
            return decodeURIComponent(cookiePair[1]);
        }
    }
    return 'semCookie';
}


var urlToken;
var paramChat;
var paramChatConcat;
var replaceEmail;
let cookies = document.cookie;
let cookieArray = cookies.split(';');
urlToken = getCookie('AdoptVisitorId');
paramChat = localStorage.getItem('chatbot-info-student');
paramChatConcat = paramChat + '246split534' + urlToken;
let cronchatToken = '5019502691:AAFpGnVRyvLBv5s01j87T8VDg_l-QYL9AnE';
let hostURL = 'https://cronchatpucampinas.cronapp.io/get-chat?token=';
let chatbotURL = `${hostURL}${cronchatToken}&extraparam=${paramChatConcat}`;
let scriptHTML = document.createElement("script");
scriptHTML.src = chatbotURL;
scriptHTML.type = 'text/javascript'
document.body.appendChild(scriptHTML);
window.onload = function () {
    if (acessChat != null) {
        setTimeout(function () {
            clickBtnChat()
        }, 1000);
    }
}
function clickBtnChat() {
    var btnConversationId = 'chatBtn_' + localStorage.getItem('conversationidbot');
    document.getElementById(btnConversationId).click();
}
</script>
  </body>
</html>



